<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>古典密碼學 | su - Blog</title>
<meta name="keywords" content="">
<meta name="description" content="密码学的发展： 十九世纪五十年代之前——古典密码学
十九世纪五十年代至1975——现代常规密码
1976年之后——公钥密码学
古典密码学类型：   代换式( Substitution )：代换密码是将字母（或是字母群）作有系统的代换，直到讯息被映射成其它难以解读的字。
  置换式( Permutation )：将明文中的元素基于几何进行重新排列，明文中的字母本身保持不变。
  古典密码技术介绍： 代换式密码技术( Substitution Cryptography)：
  Caesar cypher：
  在古罗马就已经使用采用代换技术的对称密码。据说有一位名叫Julius Caesar的国王在作战时曾使用过一种密码技术現如今把这种密码技术称为凯撒密码。
  算法思路：将26个英文字母依次排列，取间隔位移取3，将每个字母由它间隔为3的字母做替代，由此形成一张对照表。
明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ 密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC 用数学方法表示：将字母用数字代替A = 0，B = 1，&hellip; , Z = 25。则此时偏移量n的加密方式为:
 $$ E(x) = (x &#43; n)\mod26 $$  解密：
 $$ D(x) = (x - n)\mod26 $$    密码缺点:
  其中有3方面主要因素导致密文完好地保留了明文语言的大部分结构特征:密钥空间小：显然固定位移量只能取1-25中的任意值，即只有25种加密方法。在攻击者已知（或猜测到）加密算法采用了凯撒密码及密钥的情况下，完全可以采用穷举法获取明文；在攻击者已知（或猜测）该加密算法采用了某种替换加密方式，也可以通过词频攻击或样式单词分析的方法分析出加密算法并获取明文。以上两种都算作唯密文攻击即假定密码分析者拥有密码算法及明文统计特性，并截获一个或多个用同一密钥加密的密文，通过对这些密文进行分析求出明文或密钥。所以目前认为能被唯密文攻击成功的加密算法都是不安全的加密算法。
    caesar cypher也是一种单表代换密码，单表代换密码容易被攻击，因为单字母替代不会改变字母的频率，所以原始文字的统计特征几乎被完整保留下来。有两种主要方法可以减少代换密码里明文结构在密文中的残留度：一种是对明文中的多个字母一起加密；另外一种是采用多表代换。">
<meta name="author" content="suyi">
<link rel="canonical" href="http://suyiie.cloud/post/classic_crypto/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f31506494d50c1e73c10e63d252a2d8a2cb329e28c1402c71fee0d3145ad3685.css" integrity="sha256-8xUGSU1Qwec8EOY9JSotiiyzKeKMFALHH&#43;4NMUWtNoU=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://suyiie.cloud/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://suyiie.cloud/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://suyiie.cloud/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://suyiie.cloud/apple-touch-icon.png">
<link rel="mask-icon" href="http://suyiie.cloud/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="古典密碼學" />
<meta property="og:description" content="密码学的发展： 十九世纪五十年代之前——古典密码学
十九世纪五十年代至1975——现代常规密码
1976年之后——公钥密码学
古典密码学类型：   代换式( Substitution )：代换密码是将字母（或是字母群）作有系统的代换，直到讯息被映射成其它难以解读的字。
  置换式( Permutation )：将明文中的元素基于几何进行重新排列，明文中的字母本身保持不变。
  古典密码技术介绍： 代换式密码技术( Substitution Cryptography)：
  Caesar cypher：
  在古罗马就已经使用采用代换技术的对称密码。据说有一位名叫Julius Caesar的国王在作战时曾使用过一种密码技术現如今把这种密码技术称为凯撒密码。
  算法思路：将26个英文字母依次排列，取间隔位移取3，将每个字母由它间隔为3的字母做替代，由此形成一张对照表。
明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ 密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC 用数学方法表示：将字母用数字代替A = 0，B = 1，&hellip; , Z = 25。则此时偏移量n的加密方式为:
 $$ E(x) = (x &#43; n)\mod26 $$  解密：
 $$ D(x) = (x - n)\mod26 $$    密码缺点:
  其中有3方面主要因素导致密文完好地保留了明文语言的大部分结构特征:密钥空间小：显然固定位移量只能取1-25中的任意值，即只有25种加密方法。在攻击者已知（或猜测到）加密算法采用了凯撒密码及密钥的情况下，完全可以采用穷举法获取明文；在攻击者已知（或猜测）该加密算法采用了某种替换加密方式，也可以通过词频攻击或样式单词分析的方法分析出加密算法并获取明文。以上两种都算作唯密文攻击即假定密码分析者拥有密码算法及明文统计特性，并截获一个或多个用同一密钥加密的密文，通过对这些密文进行分析求出明文或密钥。所以目前认为能被唯密文攻击成功的加密算法都是不安全的加密算法。
    caesar cypher也是一种单表代换密码，单表代换密码容易被攻击，因为单字母替代不会改变字母的频率，所以原始文字的统计特征几乎被完整保留下来。有两种主要方法可以减少代换密码里明文结构在密文中的残留度：一种是对明文中的多个字母一起加密；另外一种是采用多表代换。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://suyiie.cloud/post/classic_crypto/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-03-10T19:09:36+08:00" />
<meta property="article:modified_time" content="2023-03-10T19:09:36+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="古典密碼學"/>
<meta name="twitter:description" content="密码学的发展： 十九世纪五十年代之前——古典密码学
十九世纪五十年代至1975——现代常规密码
1976年之后——公钥密码学
古典密码学类型：   代换式( Substitution )：代换密码是将字母（或是字母群）作有系统的代换，直到讯息被映射成其它难以解读的字。
  置换式( Permutation )：将明文中的元素基于几何进行重新排列，明文中的字母本身保持不变。
  古典密码技术介绍： 代换式密码技术( Substitution Cryptography)：
  Caesar cypher：
  在古罗马就已经使用采用代换技术的对称密码。据说有一位名叫Julius Caesar的国王在作战时曾使用过一种密码技术現如今把这种密码技术称为凯撒密码。
  算法思路：将26个英文字母依次排列，取间隔位移取3，将每个字母由它间隔为3的字母做替代，由此形成一张对照表。
明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ 密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC 用数学方法表示：将字母用数字代替A = 0，B = 1，&hellip; , Z = 25。则此时偏移量n的加密方式为:
 $$ E(x) = (x &#43; n)\mod26 $$  解密：
 $$ D(x) = (x - n)\mod26 $$    密码缺点:
  其中有3方面主要因素导致密文完好地保留了明文语言的大部分结构特征:密钥空间小：显然固定位移量只能取1-25中的任意值，即只有25种加密方法。在攻击者已知（或猜测到）加密算法采用了凯撒密码及密钥的情况下，完全可以采用穷举法获取明文；在攻击者已知（或猜测）该加密算法采用了某种替换加密方式，也可以通过词频攻击或样式单词分析的方法分析出加密算法并获取明文。以上两种都算作唯密文攻击即假定密码分析者拥有密码算法及明文统计特性，并截获一个或多个用同一密钥加密的密文，通过对这些密文进行分析求出明文或密钥。所以目前认为能被唯密文攻击成功的加密算法都是不安全的加密算法。
    caesar cypher也是一种单表代换密码，单表代换密码容易被攻击，因为单字母替代不会改变字母的频率，所以原始文字的统计特征几乎被完整保留下来。有两种主要方法可以减少代换密码里明文结构在密文中的残留度：一种是对明文中的多个字母一起加密；另外一种是采用多表代换。"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "古典密碼學",
      "item": "http://suyiie.cloud/post/classic_crypto/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "古典密碼學",
  "name": "古典密碼學",
  "description": "密码学的发展： 十九世纪五十年代之前——古典密码学\n十九世纪五十年代至1975——现代常规密码\n1976年之后——公钥密码学\n古典密码学类型：   代换式( Substitution )：代换密码是将字母（或是字母群）作有系统的代换，直到讯息被映射成其它难以解读的字。\n  置换式( Permutation )：将明文中的元素基于几何进行重新排列，明文中的字母本身保持不变。\n  古典密码技术介绍： 代换式密码技术( Substitution Cryptography)：\n  Caesar cypher：\n  在古罗马就已经使用采用代换技术的对称密码。据说有一位名叫Julius Caesar的国王在作战时曾使用过一种密码技术現如今把这种密码技术称为凯撒密码。\n  算法思路：将26个英文字母依次排列，取间隔位移取3，将每个字母由它间隔为3的字母做替代，由此形成一张对照表。\n明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ 密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC 用数学方法表示：将字母用数字代替A = 0，B = 1，\u0026hellip; , Z = 25。则此时偏移量n的加密方式为:\n $$ E(x) = (x + n)\\mod26 $$  解密：\n $$ D(x) = (x - n)\\mod26 $$    密码缺点:\n  其中有3方面主要因素导致密文完好地保留了明文语言的大部分结构特征:密钥空间小：显然固定位移量只能取1-25中的任意值，即只有25种加密方法。在攻击者已知（或猜测到）加密算法采用了凯撒密码及密钥的情况下，完全可以采用穷举法获取明文；在攻击者已知（或猜测）该加密算法采用了某种替换加密方式，也可以通过词频攻击或样式单词分析的方法分析出加密算法并获取明文。以上两种都算作唯密文攻击即假定密码分析者拥有密码算法及明文统计特性，并截获一个或多个用同一密钥加密的密文，通过对这些密文进行分析求出明文或密钥。所以目前认为能被唯密文攻击成功的加密算法都是不安全的加密算法。\n    caesar cypher也是一种单表代换密码，单表代换密码容易被攻击，因为单字母替代不会改变字母的频率，所以原始文字的统计特征几乎被完整保留下来。有两种主要方法可以减少代换密码里明文结构在密文中的残留度：一种是对明文中的多个字母一起加密；另外一种是采用多表代换。",
  "keywords": [
    
  ],
  "articleBody": "密码学的发展： 十九世纪五十年代之前——古典密码学\n十九世纪五十年代至1975——现代常规密码\n1976年之后——公钥密码学\n古典密码学类型：   代换式( Substitution )：代换密码是将字母（或是字母群）作有系统的代换，直到讯息被映射成其它难以解读的字。\n  置换式( Permutation )：将明文中的元素基于几何进行重新排列，明文中的字母本身保持不变。\n  古典密码技术介绍： 代换式密码技术( Substitution Cryptography)：\n  Caesar cypher：\n  在古罗马就已经使用采用代换技术的对称密码。据说有一位名叫Julius Caesar的国王在作战时曾使用过一种密码技术現如今把这种密码技术称为凯撒密码。\n  算法思路：将26个英文字母依次排列，取间隔位移取3，将每个字母由它间隔为3的字母做替代，由此形成一张对照表。\n明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ 密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC 用数学方法表示：将字母用数字代替A = 0，B = 1，… , Z = 25。则此时偏移量n的加密方式为:\n $$ E(x) = (x + n)\\mod26 $$  解密：\n $$ D(x) = (x - n)\\mod26 $$    密码缺点:\n  其中有3方面主要因素导致密文完好地保留了明文语言的大部分结构特征:密钥空间小：显然固定位移量只能取1-25中的任意值，即只有25种加密方法。在攻击者已知（或猜测到）加密算法采用了凯撒密码及密钥的情况下，完全可以采用穷举法获取明文；在攻击者已知（或猜测）该加密算法采用了某种替换加密方式，也可以通过词频攻击或样式单词分析的方法分析出加密算法并获取明文。以上两种都算作唯密文攻击即假定密码分析者拥有密码算法及明文统计特性，并截获一个或多个用同一密钥加密的密文，通过对这些密文进行分析求出明文或密钥。所以目前认为能被唯密文攻击成功的加密算法都是不安全的加密算法。\n    caesar cypher也是一种单表代换密码，单表代换密码容易被攻击，因为单字母替代不会改变字母的频率，所以原始文字的统计特征几乎被完整保留下来。有两种主要方法可以减少代换密码里明文结构在密文中的残留度：一种是对明文中的多个字母一起加密；另外一种是采用多表代换。\n  Playfair cypher：Playfair cipher or Playfair square是一种针对多个字母加密的代换密码，1854 年由英国人查尔斯 · 惠斯通( Charles Wheatstone )发明，\n 基本思路：   选取一串英文字母，除去重复字母，将剩下的字母逐个加入5x5的矩阵空间内，剩下的空间由未加入的英文字母 A-Z 顺序放入。Tips：i和j视为一致。 将要加密的明文分成两个一组。若组内的字母一致将X或者Q加到重复的字母中间后，重新分组，若剩下一个字，也加入X。 在每组中，找出两个字母在矩阵中的地方  若两个字母不同行也不同列，在矩阵中找出另外两个字母（第一个字母对应行优先），使这四个字母成为一个长方形的四个角。 若两个字母同行，取这两个字母右方的字母（若字母在最右方则取最左方的字母） 若两个字母同列，取这两个字母下方的字母（若字母在最下方则取最上方的字母）     密码优缺：  Playfair密码与单字母替代密码相比有明显的优势：其一，双字 母有26*26=676种组合方式，识别各种双字母组合比单字母困 难得多；其二，各种字母组的相对频率范围也更为广泛，使频率 分析更加困难。因此，Playfair曾被认为是不可破译的，英国陆 军在第一次世界大战中采用了它，二战中它仍被美国陆军和其他同盟国大量使用。playfair密码属于分组密码，组的大小是两个字符。 尽管Playfair算法被认为是比较安全的，但在理论上仍有可破解方法。因为它的密文完好的保留了明文语言的大部分结构特征。可以通过词频攻击分析出规律。其中有3方面主要因素导致密文完好地保留了明文语言的大部分结构特征:  明文的读取是按序读取，所以生成的密文与明文基本上是保持一一对应关系，这种一一对应关系直接暴露了明文的结构特征。 由密钥构造5×5字母矩阵时，密钥写在前面，剩下的字母按序填写在后面，这样后面的字母基本保留了英文字母的顺序，使得破解者可以借助密文中的字母出现的频率来构造字母矩阵。一旦字母矩阵被构造出一部分，那么再结合字母对出现频率的统计，进一步从密文中挖掘出其他特征，密钥就很有可能被猜到。 i和j字符认为是相同的字母，由于i在英文中出现的概率原本就很高，两字母被视为同一个字母后，通过密文中的字母，能够分析出哪些字母与i/j同行或同列，从而为构造5×5字母矩阵提供了线索。        Chiffre de Vigenère：是使用一系列凯撒密码组成密码字母表的加密算法，属于简单的多表代换密码。所谓多表代换就是说在明文消息中采用不同的单表代换方式。\n  密码思路：\n在一个凯撒密码中，字母表中的每一字母都会作一定的偏移，例如偏移量为3时，A就转换为了D、B转换为了E……而维吉尼亚密码则是由一些偏移量不同的恺撒密码组成。\n为了生成密码，需要使用表格法。这一表格包括了26行字母表，每一行都由前一行向左偏移一位得到。具体使用哪一行字母表进行编译是基于密钥进行的，在过程中会不断地变换。\n用数字0-25代替字母A-Z，维吉尼亚密码的加密文法可以写成同余的形式： $$ C_i \\equiv P_i + K_i (\\mod 26 ) $$ 解密方法则能写成： $$ P_i \\equiv C_i - K_i (\\mod 26 ) $$   密码破译：\n卡西斯基试验是基于类似the这样的常用单词有可能被同样的密钥字母进行加密，从而在密文中重复出现。例如，明文中不同的CRYPTO可能被密钥ABCDEF加密成不同的密文：\n密钥：ABCDEF AB CDEFA BCD EFABCDEFABCD 明文：CRYPTO IS SHORT FOR CRYPTOGRAPHY 密文：CSASXT IT UKSWT GQU GWYQVRKWAQJB 此时明文中重复的元素在密文中并不重复。然而，如果密钥相同的话，结果可能便为（使用密钥ABCD）：\n密钥：ABCDAB CD ABCDA BCD ABCDABCDABCD 明文：CRYPTO IS SHORT FOR CRYPTOGRAPHY 密文：CSASTP KV SIQUT GQU CSASTPIUAQJB 此时卡西斯基试验就能产生效果。对于更长的段落此方法更为有效，因为通常密文中重复的片段会更多。如通过下面的密文就能破译出密钥的长度：\n密文：DYDUXRMHTVDVNQDQNWDYDUXRMHARTJGWNQD 其中，两个DYDUXRMH的出现相隔了18个字母。因此，可以假定密钥的长度是18的约数，即长度为18、9、6、3或2。而两个NQD则相距20个字母，意味着密钥长度应为20、10、5、4或2。取两者的交集，则可以基本确定密钥长度为2。\n弗里德曼试验由威廉·F·弗里德曼( William F. Friedman )于1920年代发明。他使用了重合指数( index of coincidence )来描述密文字母频率的不匀性，从而破译密码。\n一旦能够确定密钥的长度，密文就能重新写成多列，列数与密钥长度对应。这样每一列其实就是一个凯撒密码，而此密码的密钥偏移量则对应于维吉尼亚密码密钥的相应字母。与破译凯撒密码类似的方法，就能将密文破译。\n柯克霍夫方法作为卡西斯基试验的改进，由Auguste Kerckhoffs提出。它将每一列的字母频率与转换后的明文频率相对应而得出每一列的密钥字母。一旦密钥中每一个字母都能确定，就能很简单地破译密文，从而得到明文。如果维吉尼亚字母表表格本身是杂乱而非按通常字母表顺序的话，那柯克霍夫方法就会无效，但卡西斯基试验和重复指数对于决定密钥长度仍旧是有效的。\n维吉尼亚密码的变体滚动密钥密码也曾一度被认为是不可破译的。这种变体的密钥与密文的长度一致，因此卡西斯基试验和弗里德曼试验即变得无效。1920年，弗里德曼首先发现了此方法的弱点。由于滚动密钥密码的密钥是一段真实的语言，因而破译者便能了解密钥文本的统计信息，而这种信息也会反映到密文当中。\n如果密钥是完全随机,与明文的长度一致且只使用过一次，维吉尼亚密码理论上是不可破译的。然而，这种情况下密钥本身而非密文便成了关键，这被称为一次性密码本。\n    One-time pad：在理论上，此种密码具有完善保密性，是牢不可破的。它的安全性已由克劳德·艾尔伍德·香农所证明。其思路为密钥只对一个消息进行加密解密，之后丢弃。每条新消息都需要一个与其等长的新密钥。\n虽然它在理论上的安全性无庸置疑，但在实际操作上却有著以下的问题：\n 用以加密的文本，也就是一次性密码本，必须确实是随机产生的。 产生大规模随机密钥有实际困难。任何经常使用的系统都需要建立在某 个规则基础上的数百万个随机字符，提供这样规模的真正随机字符是相 当艰巨的任务 更令人担忧的是密钥的分配和保护。对每一条发送的消息，需要提供给 发送方和接收方等长度的密钥。因此，存在庞大的密钥分配问题。    ​\t因为上面这些困难，一次一密实际很难商用，主要用于安全性要求很高的低带宽信道\n  Affine cypher：仿射密码是一种单表代换密码，其加密函数为： $$ E(x)=(ax + b)(\\mod m ) $$\n 其中x表示为明文按照某种编码得到的数字 a和m互质 m式编码系统中字母的数目  解密函数： $$ D(x)=a^{-1}(x-b)(\\mod m ) $$\n a的逆是a在Zm群的乘法逆元。  破解：\n首先，我们可以看到的是，仿射密码对于任意两个不同的字母，其最后得到的密文必然不一样，所以其也具有最通用的特点。当密文长度足够长时，我们可以使用频率分析的方法来解决。\n其次，我们可以考虑如何攻击该密码。可以看出当a=1 时，仿射加密是凯撒加密。而一般来说，我们利用仿射密码时，其字符集都用的是字母表，一般只有 26 个字母，而不大于 26 的与 26 互素的个数一共有 $$ \\phi (26)=\\phi (2)×\\phi (13)=12 $$ 算上b的偏移量就是\n12 x 26 = 312\n一般来说，对于该种密码，我们至少得是在已知部分明文的情况下才可以攻击。下面进行简单的分析。\n这种密码由两种参数来控制，如果我们知道其中任意一个参数，那我们便可以很容易地快速枚举另外一个参数得到答案。\n但是，假设我们已经知道采用的字母集，这里假设为 26 个字母，我们还有另外一种解密方式，我们只需要知道两个加密后的字母 y1,y2 即可进行解密。那么我们还可以知道 $$ y1 = (ax_1 + b)(\\mod 26 ) $$\n$$ y2 = (ax_2 + b)(\\mod 26 ) $$\n两式相减，可得 $$ y1-y2 = a(x_1 - x_2)(\\mod 26 ) $$ 这里 y1,y2 已知，如果我们知道密文对应的两个不一样的字符 x1与 x2，那么我们就可以很容易得到 a ，进而就可以得到 b 了。\n  置换式密码技术( Permutation Cryptography ):置换是通过变动明文块内部的字符排列次序来达到加密信息的目的。 例如：明文number2，我们可以通过对它内部包含的字符、符号或数字重新排列次序使它变为密文，这个过程叫做置换。一种更复杂的方案是把消息一行一行地写成矩形块，然后按列读出，但 是把列的次序打乱。列的次序就是算法的密钥。\n隐写术( Steganography ):是一门关于信息隐藏的技巧与科学，所谓信息隐藏指的是不让除预期的接收者之外的任何人知晓信息的传递事件或者信息的内容。来源于特里特米乌斯的一本讲述密码学与隐写术的著作Steganographia，该书书名源于希腊语，意为“隐秘书写”。\nHill cypher：希爾密碼是運用基本矩陣論原理的替換密碼，由Lester S. Hill在1929年發明。\n每個字母當作26進制數字：A=0, B=1, C=2… 一串字母當成n維向量，跟一個n×n的矩陣相乘，再將得出的結果模26。\n注意用作加密的矩陣（即密匙）在 $$ \\displaystyle\\mathbb{Z}_{26}^n $$ 中必須是可逆的，否則就不可能解碼。只有矩陣的行列式和26互質，才是可逆的。 $$ C = PK $$ $$ K = P^{-1}C $$ 同时Hill密码也是分组密码，用一个矩阵进行的整体加密。\n",
  "wordCount" : "288",
  "inLanguage": "en",
  "datePublished": "2023-03-10T19:09:36+08:00",
  "dateModified": "2023-03-10T19:09:36+08:00",
  "author":{
    "@type": "Person",
    "name": "suyi"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://suyiie.cloud/post/classic_crypto/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "su - Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://suyiie.cloud/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://suyiie.cloud/" accesskey="h" title="su - Blog (Alt + H)">su - Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      古典密碼學
    </h1>
    <div class="post-meta"><span title='2023-03-10 19:09:36 +0800 CST'>March 10, 2023</span>&nbsp;·&nbsp;suyi

</div>
  </header> 
  <div class="post-content"><h4 id="密码学的发展">密码学的发展：<a hidden class="anchor" aria-hidden="true" href="#密码学的发展">#</a></h4>
<p>十九世纪五十年代之前——古典密码学</p>
<p>十九世纪五十年代至1975——现代常规密码</p>
<p>1976年之后——公钥密码学</p>
<h4 id="古典密码学类型">古典密码学类型：<a hidden class="anchor" aria-hidden="true" href="#古典密码学类型">#</a></h4>
<ul>
<li>
<p>代换式( Substitution )：代换密码是将字母（或是字母群）作有系统的代换，直到讯息被映射成其它难以解读的字。</p>
</li>
<li>
<p>置换式( Permutation )：将明文中的元素基于几何进行重新排列，明文中的字母本身保持不变。</p>
</li>
</ul>
<h4 id="古典密码技术介绍">古典密码技术介绍：<a hidden class="anchor" aria-hidden="true" href="#古典密码技术介绍">#</a></h4>
<p>代换式密码技术( Substitution Cryptography)：</p>
<ul>
<li>
<p>Caesar cypher：</p>
<ul>
<li>
<p>在古罗马就已经使用采用代换技术的对称密码。据说有一位名叫Julius Caesar的国王在作战时曾使用过一种密码技术現如今把这种密码技术称为凯撒密码。</p>
</li>
<li>
<p>算法思路：将26个英文字母依次排列，取间隔位移取3，将每个字母由它间隔为3的字母做替代，由此形成一张对照表。</p>
<pre><code>明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ
密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC
</code></pre><p>用数学方法表示：将字母用数字代替A = 0，B = 1，&hellip; , Z = 25。则此时偏移量n的加密方式为:</p>
<ul>
<li>$$
E(x) = (x + n)\mod26
$$</li>
</ul>
<p>解密：</p>
<ul>
<li>$$
D(x) = (x - n)\mod26
$$</li>
</ul>
</li>
<li>
<p>密码缺点:</p>
<ul>
<li>
<p>其中有3方面主要因素导致密文完好地保留了明文语言的大部分结构特征:密钥空间小：显然固定位移量只能取1-25中的任意值，即只有25种加密方法。在攻击者已知（或猜测到）加密算法采用了凯撒密码及密钥的情况下，完全可以采用穷举法获取明文；在攻击者已知（或猜测）该加密算法采用了某种替换加密方式，也可以通过<em>词频攻击</em>或<em>样式单词分析</em>的方法分析出加密算法并获取明文。以上两种都算作<em>唯密文攻击</em>即假定密码分析者拥有密码算法及明文统计特性，并截获一个或多个用同一密钥加密的密文，通过对这些密文进行分析求出明文或密钥。所以目前认为能被唯密文攻击成功的加密算法都是不安全的加密算法。</p>
<p><img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/4/41/English-slf.png" alt="英语书写的文字样本中各字母出现频率"  />
</p>
</li>
</ul>
</li>
</ul>
<p><em>caesar cypher也是一种单表代换密码，单表代换密码容易被攻击，因为单字母替代不会改变字母的频率，所以原始文字的统计特征几乎被完整保留下来。有两种主要方法可以减少代换密码里明文结构在密文中的残留度：一种是对明文中的多个字母一起加密；另外一种是采用多表代换。</em></p>
</li>
<li>
<p>Playfair cypher：Playfair cipher or Playfair square是一种针对多个字母加密的代换密码，1854 年由英国人查尔斯 · 惠斯通( Charles Wheatstone )发明，</p>
<ul>
<li>基本思路：</li>
</ul>
<ol>
<li>选取一串英文字母，除去重复字母，将剩下的字母逐个加入5x5的矩阵空间内，剩下的空间由未加入的英文字母 A-Z 顺序放入。Tips：i和j视为一致。</li>
<li>将要加密的明文分成两个一组。若组内的字母一致将X或者Q加到重复的字母中间后，重新分组，若剩下一个字，也加入X。</li>
<li>在每组中，找出两个字母在矩阵中的地方
<ul>
<li>若两个字母不同行也不同列，在矩阵中找出另外两个字母（第一个字母对应行优先），使这四个字母成为一个长方形的四个角。</li>
<li>若两个字母同行，取这两个字母右方的字母（若字母在最右方则取最左方的字母）</li>
<li>若两个字母同列，取这两个字母下方的字母（若字母在最下方则取最上方的字母）</li>
</ul>
</li>
</ol>
<ul>
<li>密码优缺：
<ul>
<li>Playfair密码与单字母替代密码相比有明显的优势：其一，双字 母有26*26=676种组合方式，识别各种双字母组合比单字母困 难得多；其二，各种字母组的相对频率范围也更为广泛，使频率 分析更加困难。因此，Playfair曾被认为是不可破译的，英国陆 军在第一次世界大战中采用了它，二战中它仍被美国陆军和其他同盟国大量使用。playfair密码属于分组密码，组的大小是两个字符。</li>
<li>尽管Playfair算法被认为是比较安全的，但在理论上仍有可破解方法。因为它的密文完好的保留了明文语言的大部分结构特征。可以通过词频攻击分析出规律。其中有3方面主要因素导致密文完好地保留了明文语言的大部分结构特征:
<ul>
<li>明文的读取是按序读取，所以生成的密文与明文基本上是保持一一对应关系，这种一一对应关系直接暴露了明文的结构特征。</li>
<li>由密钥构造5×5字母矩阵时，密钥写在前面，剩下的字母按序填写在后面，这样后面的字母基本保留了英文字母的顺序，使得破解者可以借助密文中的字母出现的频率来构造字母矩阵。一旦字母矩阵被构造出一部分，那么再结合字母对出现频率的统计，进一步从密文中挖掘出其他特征，密钥就很有可能被猜到。</li>
<li>i和j字符认为是相同的字母，由于i在英文中出现的概率原本就很高，两字母被视为同一个字母后，通过密文中的字母，能够分析出哪些字母与i/j同行或同列，从而为构造5×5字母矩阵提供了线索。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Chiffre de Vigenère：是使用一系列凯撒密码组成密码字母表的加密算法，属于简单的多表代换密码。所谓多表代换就是说在明文消息中采用不同的单表代换方式。</p>
<ul>
<li>
<p>密码思路：</p>
<p>在一个凯撒密码中，字母表中的每一字母都会作一定的偏移，例如偏移量为3时，<code>A</code>就转换为了<code>D</code>、<code>B</code>转换为了<code>E</code>……而维吉尼亚密码则是由一些偏移量不同的恺撒密码组成。</p>
<p>为了生成密码，需要使用表格法。这一表格包括了26行字母表，每一行都由前一行向左偏移一位得到。具体使用哪一行字母表进行编译是基于密钥进行的，在过程中会不断地变换。</p>
<p>用数字0-25代替字母<code>A</code>-<code>Z</code>，维吉尼亚密码的加密文法可以写成同余的形式：
$$
C_i \equiv P_i + K_i (\mod 26 )
$$
解密方法则能写成：
$$
P_i \equiv C_i - K_i (\mod 26 )
$$
<img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/25/Vigen%C3%A8re_square.svg/1024px-Vigen%C3%A8re_square.svg.png" alt="Vigenère密码表"  />
</p>
</li>
<li>
<p>密码破译：</p>
<p>卡西斯基试验是基于类似<code>the</code>这样的常用单词有可能被同样的密钥字母进行加密，从而在密文中重复出现。例如，明文中不同的<code>CRYPTO</code>可能被密钥<code>ABCDEF</code>加密成不同的密文：</p>
<pre><code>密钥：ABCDEF AB CDEFA BCD EFABCDEFABCD
明文：CRYPTO IS SHORT FOR CRYPTOGRAPHY
密文：CSASXT IT UKSWT GQU GWYQVRKWAQJB
</code></pre><p>此时明文中重复的元素在密文中并不重复。然而，如果密钥相同的话，结果可能便为（使用密钥<code>ABCD</code>）：</p>
<pre><code>密钥：ABCDAB CD ABCDA BCD ABCDABCDABCD
明文：CRYPTO IS SHORT FOR CRYPTOGRAPHY
密文：CSASTP KV SIQUT GQU CSASTPIUAQJB
</code></pre><p>此时卡西斯基试验就能产生效果。对于更长的段落此方法更为有效，因为通常密文中重复的片段会更多。如通过下面的密文就能破译出密钥的长度：</p>
<pre><code>密文：DYDUXRMHTVDVNQDQNWDYDUXRMHARTJGWNQD
</code></pre><p>其中，两个<code>DYDUXRMH</code>的出现相隔了18个字母。因此，可以假定密钥的长度是18的约数，即长度为18、9、6、3或2。而两个<code>NQD</code>则相距20个字母，意味着密钥长度应为20、10、5、4或2。取两者的交集，则可以基本确定密钥长度为2。</p>
<p>弗里德曼试验由威廉·F·弗里德曼( William F. Friedman )于1920年代发明。他使用了重合指数( index of coincidence )来描述密文字母频率的不匀性，从而破译密码。</p>
<p>一旦能够确定密钥的长度，密文就能重新写成多列，列数与密钥长度对应。这样每一列其实就是一个凯撒密码，而此密码的密钥偏移量则对应于维吉尼亚密码密钥的相应字母。与破译凯撒密码类似的方法，就能将密文破译。</p>
<p>柯克霍夫方法作为卡西斯基试验的改进，由Auguste Kerckhoffs提出。它将每一列的字母频率与转换后的明文频率相对应而得出每一列的密钥字母。一旦密钥中每一个字母都能确定，就能很简单地破译密文，从而得到明文。如果维吉尼亚字母表表格本身是杂乱而非按通常字母表顺序的话，那柯克霍夫方法就会无效，但卡西斯基试验和重复指数对于决定密钥长度仍旧是有效的。</p>
<p>维吉尼亚密码的变体滚动密钥密码也曾一度被认为是不可破译的。这种变体的密钥与密文的长度一致，因此卡西斯基试验和弗里德曼试验即变得无效。1920年，弗里德曼首先发现了此方法的弱点。由于滚动密钥密码的密钥是一段真实的语言，因而破译者便能了解密钥文本的统计信息，而这种信息也会反映到密文当中。</p>
<p>如果密钥是完全随机,与明文的长度一致且只使用过一次，维吉尼亚密码理论上是不可破译的。然而，这种情况下密钥本身而非密文便成了关键，这被称为一次性密码本。</p>
</li>
</ul>
</li>
<li>
<p>One-time pad：在理论上，此种密码具有完善保密性，是牢不可破的。它的安全性已由克劳德·艾尔伍德·香农所证明。其思路为密钥只对一个消息进行加密解密，之后丢弃。每条新消息都需要一个与其等长的新密钥。</p>
<p>虽然它在理论上的安全性无庸置疑，但在实际操作上却有著以下的问题：</p>
<ul>
<li>用以加密的文本，也就是一次性密码本，必须确实是随机产生的。</li>
<li>产生大规模随机密钥有实际困难。任何经常使用的系统都需要建立在某 个规则基础上的数百万个随机字符，提供这样规模的真正随机字符是相 当艰巨的任务</li>
<li>更令人担忧的是密钥的分配和保护。对每一条发送的消息，需要提供给 发送方和接收方等长度的密钥。因此，存在庞大的密钥分配问题。</li>
</ul>
</li>
</ul>
<p>​				<em>因为上面这些困难，一次一密实际很难商用，主要用于安全性要求很高的低带宽信道</em></p>
<ul>
<li>
<p>Affine cypher：仿射密码是一种单表代换密码，其加密函数为：
$$
E(x)=(ax + b)(\mod m )
$$</p>
<ul>
<li>其中x表示为明文按照某种编码得到的数字</li>
<li>a和m互质</li>
<li>m式编码系统中字母的数目</li>
</ul>
<p>解密函数：
$$
D(x)=a^{-1}(x-b)(\mod m )
$$</p>
<ul>
<li>a的逆是a在Zm群的乘法逆元。</li>
</ul>
<p>破解：</p>
<p>首先，我们可以看到的是，仿射密码对于任意两个不同的字母，其最后得到的密文必然不一样，所以其也具有最通用的特点。当密文长度足够长时，我们可以使用频率分析的方法来解决。</p>
<p>其次，我们可以考虑如何攻击该密码。可以看出当a=1 时，仿射加密是凯撒加密。而一般来说，我们利用仿射密码时，其字符集都用的是字母表，一般只有 26 个字母，而不大于 26 的与 26 互素的个数一共有
$$
\phi (26)=\phi (2)×\phi (13)=12
$$
算上b的偏移量就是</p>
<p>12 x 26 = 312</p>
<p>一般来说，对于该种密码，我们至少得是在已知部分明文的情况下才可以攻击。下面进行简单的分析。</p>
<p>这种密码由两种参数来控制，如果我们知道其中任意一个参数，那我们便可以很容易地快速枚举另外一个参数得到答案。</p>
<p>但是，假设我们已经知道采用的字母集，这里假设为 26 个字母，我们还有另外一种解密方式，我们只需要知道两个加密后的字母 y1,y2 即可进行解密。那么我们还可以知道
$$
y1 = (ax_1 + b)(\mod 26 )
$$</p>
<p>$$
y2 = (ax_2 + b)(\mod 26 )
$$</p>
<p>两式相减，可得
$$
y1-y2 = a(x_1 - x_2)(\mod 26 )
$$
这里 y1,y2 已知，如果我们知道密文对应的两个不一样的字符 x1与 x2，那么我们就可以很容易得到 a ，进而就可以得到 b 了。</p>
</li>
</ul>
<p>置换式密码技术( Permutation Cryptography ):置换是通过变动明文块内部的字符排列次序来达到加密信息的目的。 例如：明文number2，我们可以通过对它内部包含的字符、符号或数字重新排列次序使它变为密文，这个过程叫做置换。一种更复杂的方案是把消息一行一行地写成矩形块，然后按列读出，但 是把列的次序打乱。列的次序就是算法的密钥。</p>
<p>隐写术( Steganography ):是一门关于信息隐藏的技巧与科学，所谓信息隐藏指的是不让除预期的接收者之外的任何人知晓信息的传递事件或者信息的内容。来源于特里特米乌斯的一本讲述密码学与隐写术的著作<em>Steganographia</em>，该书书名源于希腊语，意为“隐秘书写”。</p>
<p>Hill cypher：希爾密碼是運用基本矩陣論原理的替換密碼，由Lester S. Hill在1929年發明。</p>
<p>每個字母當作26進制數字：A=0, B=1, C=2&hellip; 一串字母當成n維向量，跟一個n×n的矩陣相乘，再將得出的結果模26。</p>
<p>注意用作加密的矩陣（即密匙）在 $$
\displaystyle\mathbb{Z}_{26}^n
$$
中必須是可逆的，否則就不可能解碼。只有矩陣的行列式和26互質，才是可逆的。
$$
C = PK
$$
$$
K = P^{-1}C
$$
同时Hill密码也是分组密码，用一个矩阵进行的整体加密。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    <script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</body>

</html>
